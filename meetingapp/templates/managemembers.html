{% extends "base.html" %}

{% block content %}

{% load static %}

<link href="{% static "formbase.css" %}" rel="stylesheet" type="text/css">


<style>

.form-horizontal .control-label {
	width: 185px !important;
	text-align: center;
}

.form-horizontal .controls {
	padding-left: 30px !important;
}

</style>

<div class="center_block container" style="width: 80%;">
	<div class="form_block" style="width: 60%;">
		<form class="form-horizontal" method="post">
			{% csrf_token %}
			<div class="control-group">
				<div class="controls">
					<h3>Manage Members</h3>
				</div>
			</div>
			<div class="control-group">
				<div class="controls">
					<h4>Manage Existing Members:</h4>
				</div>
			</div>
			<div class="control-group">
				<label class="control-label">
					<a class="btn" data-toggle="modal" role="button" href="#removeModal" style="padding: 5px !important;">Remove members </a>
				</label>
					<input type="hidden" id="remove_members" name="remove_members" />
				<div class="controls" id="acknowledge_remove">
					<text style="line-height: 45px;">No members selected.</text>
				</div>
			</div>
			<div class="control-group">
				<label class="control-label">
					<a class="btn" data-toggle="modal" role="button" href="#promoteModal" style="padding: 5px !important;">Promote to moderator </a>
				</label>
					<input type="hidden" id="promote_members" name="promote_members" />
				<div class="controls" id="acknowledge_promote">
					<text style="line-height: 45px;">No members selected.</text>
				</div>
			</div>
			<div class="control-group">
				<div class="controls">
					<h4>Or invite new members:</h4>
				</div>
			</div>
			<div class="control-group">
				<label class="control-label">Send email invites:</label>
				<div class="controls">
					<textarea name="entered" style="width: 300px; height: 82px;" placeholder="One email per line."></textarea>
				</div>
			</div>
			<div class="control-group">
				<label class="control-label">
					<a class="cs_import btn" style="padding: 5px !important;">Invite from Address Book</a><br>
					<img src="{% static "google.png" %}" class="addrbook">
					<img src="{% static "apple.png" %}" class="addrbook">
					<img src="{% static "yahoo.png" %}" class="addrbook">
					<img src="{% static "aol.png" %}" class="addrbook">
					<img src="{% static "msn.png" %}" class="addrbook">
				</label>
				<div class="controls">
					<textarea name="addr_contacts" style="width:300px;height:82px" id="contact_list"></textarea>
				</div>
			</div>
			<div class="control-group">
				<label class="control-label">
					<a class="btn" data-toggle="modal" role="button" href="#inviteModal" style="padding: 5px !important;">Invite from contacts </a>
				</label>
					<input type="hidden" id="from_contacts" name="from_contacts" />
				<div class="controls" id="acknowledge">
					<text style="line-height: 45px;">No contacts selected.</text>
				</div>
			</div>
			<div class="control-group">
				<div class="controls">
					<button type="submit" class="btn btn-primary">Save Changes</button>
					<a href="../meeting/{{meeting.meeting_id}}" class="btn btn-danger">Return to Meeting</a>
				</div>
			</div>
		</form>
	</div>
</div>

<div id="inviteModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel">Invite From Contacts</h3>
  </div>
  <div class="modal-body">
    <div class="innerCheckbox">
    	{% for contact in account.contacts.all %}
	    	<div class="cboxContact">
		    	<input type="checkbox" name="c_select" value="{{contact.id}}"></input><span style="margin-left: 10px;">
		    	{% if contact.last_name %}{{contact.last_name}}{% endif %}
		    	{% if contact.last_name %}{% if contact.first_name %}, {% endif %}{% endif %}
		    	{% if contact.first_name %}{{contact.first_name}} {% endif %}
		    	{% if contact.last_name %}<<em>{{contact.email}}</em>>{% endif %}
			    {% if contact.first_name %}<<em>{{contact.email}}</em>{% endif %}
				{% if contact.last_name %}{% else %}{% if contact.last_name %}{% else %}{{contact.email}}{% endif %}{% endif %}</span>
		    </div>
    	{% endfor %}
    </div>
  </div>
  <div class="modal-footer">
    <button type="button" data-dismiss="modal" id="confirm_contacts" class="btn btn-primary">Ok</button>
  </div>
</div>

<div id="removeModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel">Remove from Meeting</h3>
  </div>
  <div class="modal-body">
    <div class="innerCheckbox">
    	{% for member in members_to_remove %}
	    	<div class="cboxContact">
		    	<input type="checkbox" name="r_select" value="{{member.id}}"></input><span style="margin-left: 10px;">
		    	{% if member.user.last_name %}{{member.user.last_name}}{% endif %}
		    	{% if member.user.last_name %}{% if member.user.first_name %}, {% endif %}{% endif %}
		    	{% if member.user.first_name %}{{member.user.first_name}} {% endif %}
		    	{% if member.user.last_name %}<<em>{{member.user.email}}</em>>{% endif %}
			    {% if member.user.first_name %}<<em>{{member.user.email}}</em>{% endif %}
				{% if member.user.last_name %}{% else %}{% if member.user.last_name %}{% else %}{{member.user.email}}{% endif %}{% endif %}</span>
		    </div>
    	{% endfor %}
    </div>
  </div>
  <div class="modal-footer">
    <button type="button" data-dismiss="modal" id="confirm_remove" class="btn btn-primary">Ok</button>
  </div>
</div>

<div id="promoteModal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel">Promote to Moderator</h3>
  </div>
  <div class="modal-body">
    <div class="innerCheckbox">
    	{% for member in members_to_mod %}
	    	<div class="cboxContact">
		    	<input type="checkbox" name="p_select" value="{{member.id}}"></input><span style="margin-left: 10px;">
		    	{% if member.user.last_name %}{{member.user.last_name}}{% endif %}
		    	{% if member.user.last_name %}{% if member.user.first_name %}, {% endif %}{% endif %}
		    	{% if member.user.first_name %}{{member.user.first_name}} {% endif %}
		    	{% if member.user.last_name %}<<em>{{member.user.email}}</em>>{% endif %}
			    {% if member.user.first_name %}<<em>{{member.user.email}}</em>{% endif %}
				{% if member.user.last_name %}{% else %}{% if member.user.last_name %}{% else %}{{member.user.email}}{% endif %}{% endif %}</span>
		    </div>
    	{% endfor %}
    </div>
  </div>
  <div class="modal-footer">
    <button type="button" data-dismiss="modal" id="confirm_promote" class="btn btn-primary">Ok</button>
  </div>
</div>


<script>
$(function() {

	$('#confirm_contacts').click(function() {
		added = '';
		$('input[name=c_select]:checked').each(function() {
			added += $(this).val() + ' ';
		});
		$('#from_contacts').val(added);
		$('#acknowledge').html('<text style="line-height: 45px; color:#08c;">Contacts added successfully.</text>');
	});

	$('#confirm_remove').click(function() {
		added = '';
		$('input[name=r_select]:checked').each(function() {
			added += $(this).val() + ' ';
		});
		$('#remove_members').val(added);
		$('#acknowledge_remove').html('<text style="line-height: 45px; color:#08c;">Members removed successfully.</text>');
	});

	$('#confirm_promote').click(function() {
		added = '';
		$('input[name=p_select]:checked').each(function() {
			added += $(this).val() + ' ';
		});
		$('#promote_members').val(added);
		$('#acknowledge_promote').html('<text style="line-height: 45px; color:#08c;">Members removed successfully.</text>');
	});

});

</script>

<script>
	var csPageOptions = {
	  domain_key:"RZ7M43JLPAH6JHE45ATN", 
	  textarea_id:"contact_list",
	  ignoreMultipleEmails:true,
	};
</script>

<script type="text/javascript" src="https://api.cloudsponge.com/address_books.js"></script>

{% endblock %}